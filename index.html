<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Kit TerapÃ©utico Interactivo ðŸŒ¿</title>
<link rel="manifest" href="manifest.json">
<style>
  :root {
    --verde: #40916c;
    --suave: #d8f3dc;
    --fondo: #f7fcfa;
  }
  body {
    font-family: "Poppins", sans-serif;
    background: var(--fondo);
    margin: 0; padding: 0;
    display: flex; flex-direction: column;
    align-items: center;
    min-height: 100vh;
  }
  header {
    background: var(--verde);
    color: white;
    width: 100%;
    text-align: center;
    padding: 10px 0;
  }
  main {
    flex: 1;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: start;
    width: 100%;
    max-width: 480px;
    padding: 20px;
  }
  .card, .form-inicio, .reflexion-card {
    background: white;
    border-radius: 12px;
    padding: 20px;
    width: 100%;
    box-shadow: 0 3px 10px rgba(0,0,0,0.1);
    margin-top: 20px;
  }
  .oculto { display: none; }
  select, input, textarea, button {
    width: 100%;
    padding: 10px;
    margin: 10px 0;
    border: none;
    border-radius: 8px;
    font-size: 1rem;
  }
  select, input, textarea {
    background: #f0f0f0;
  }
  button {
    background: var(--verde);
    color: white;
    cursor: pointer;
    font-weight: bold;
  }
  button:hover { background: #2e684e; }
  textarea { min-height: 80px; resize: none; }
  footer {
    text-align: center;
    padding: 10px;
    font-size: 0.85rem;
    color: #777;
  }
</style>
</head>
<body>
<header><h2>ðŸŒ¿ Kit TerapÃ©utico Ruaj</h2></header>
<main>
  <!-- Pantalla de registro -->
  <div id="pantallaInicio" class="form-inicio">
    <h3>Bienvenido/a</h3>
    <p>Antes de comenzar, por favor completa tus datos:</p>
    <input id="nombre" type="text" placeholder="Tu nombre" required>
    <input id="email" type="email" placeholder="Tu correo electrÃ³nico" required>
    <button onclick="iniciarSesion()">Comenzar</button>
  </div>
  <!-- App principal -->
  <div id="appPrincipal" class="oculto">
    <select id="categoria">
      <option value="emocional">ðŸ’— Emocional</option>
      <option value="mental">ðŸ§  Mental</option>
      <option value="fisica">ðŸŒ¿ FÃ­sica</option>
    </select>
    <button onclick="mostrarTarjeta()">Sacar tarjeta</button>

    <div id="tarjeta" class="card">ðŸŒ¸ Tu pregunta aparecerÃ¡ aquÃ­</div>
    <div id="dinamica" class="card">Selecciona una categorÃ­a para ver su dinÃ¡mica.</div>

    <div class="reflexion-card">
      <label for="reflexion"><strong>Tu reflexiÃ³n:</strong></label>
      <textarea id="reflexion" placeholder="Escribe lo que sientes..."></textarea>
      <button onclick="guardarReflexion()">ðŸ’¾ Guardar reflexiÃ³n</button>
    </div>
  </div>
</main>
<footer>Creado con amor para tu transformaciÃ³n ðŸŒ¸</footer>

<script>
const SCRIPT_URL = "https://script.google.com/macros/s/AKfycby2GV7b3P0UFfTl1BKNTT47HGhLO4-vdE1DdcYTljZq3H1gphYHLgoMnF4ejKYvfJnL/exec"; // ðŸ”— ReemplÃ¡zalo
const preguntas = {
  emocional: [
    "Â¿QuÃ© emociÃ³n estoy negando o evitando sentir en este momento?",
    "Â¿DÃ³nde siento esta emociÃ³n en el cuerpo?",
    "Â¿QuÃ© mensaje tiene para mÃ­ esta emociÃ³n si la escucho sin juicio?",
    "Â¿QuÃ© me harÃ­a sentir mÃ¡s seguro(a) para expresarla plenamente?",
    "Â¿QuÃ© emociones heredadas o aprendidas estoy listo(a) para liberar?"
  ],
  mental: [
    "Â¿QuÃ© pensamientos repetitivos me mantienen atrapado(a) en un bucle?",
    "Â¿QuÃ© creencia sostiene este pensamiento?",
    "Â¿QuÃ© beneficios inconscientes obtengo al mantener esta creencia?",
    "Â¿QuÃ© pasarÃ­a si decidiera creer lo contrario durante una semana?",
    "Â¿QuÃ© afirmaciÃ³n consciente quiero sembrar hoy?"
  ],
  fisica: [
    "Â¿DÃ³nde se acumula la tensiÃ³n en mi cuerpo cuando estoy bajo estrÃ©s?",
    "Â¿QuÃ© parte de mi cuerpo me pide atenciÃ³n o descanso hoy?",
    "Â¿QuÃ© emociones reconozco alojadas en mi cuerpo?",
    "Â¿QuÃ© movimientos o posturas me ayudan a liberar energÃ­a estancada?",
    "Â¿QuÃ© gesto pequeÃ±o puedo hacer hoy para honrar mi cuerpo?"
  ]
};
const dinamicas = {
  emocional:
    "ðŸŒ€ <strong>DinÃ¡mica:</strong> Escribe una emociÃ³n recurrente, hÃ¡blale, agradÃ©cele y suÃ©ltala (puedes romper la hoja con intenciÃ³n de liberaciÃ³n).",
  mental:
    "ðŸ’« <strong>DinÃ¡mica:</strong> Identifica tus creencias limitantes y reescrÃ­belas en versiones expansivas. RepÃ­telas frente al espejo una semana.",
  fisica:
    "ðŸŒ¿ <strong>DinÃ¡mica:</strong> Haz un escaneo corporal consciente, siente cada parte, agradece y visualiza luz liberando tensiÃ³n."
};

function iniciarSesion() {
  const nombre = document.getElementById("nombre").value.trim();
  const email = document.getElementById("email").value.trim();
  if (!nombre || !email) {
    alert("Por favor completa todos los campos.");
    return;
  }
  localStorage.setItem("nombreUsuario", nombre);
  localStorage.setItem("emailUsuario", email);
  document.getElementById("pantallaInicio").classList.add("oculto");
  document.getElementById("appPrincipal").classList.remove("oculto");
}

function mostrarTarjeta() {
  const categoria = document.getElementById("categoria").value;
  const lista = preguntas[categoria];
  const pregunta = lista[Math.floor(Math.random() * lista.length)];
  document.getElementById("tarjeta").innerText = pregunta;
  document.getElementById("dinamica").innerHTML = dinamicas[categoria];
}

async function guardarReflexion() {
  const nombre = localStorage.getItem("nombreUsuario");
  const email = localStorage.getItem("emailUsuario");
  const categoria = document.getElementById("categoria").value;
  const pregunta = document.getElementById("tarjeta").innerText;
  const comentario = document.getElementById("reflexion").value.trim();

  if (!pregunta || pregunta.includes("aparecerÃ¡") || comentario === "") {
    alert("Primero selecciona una tarjeta y escribe tu reflexiÃ³n.");
    return;
  }

  const data = { nombre, email, categoria, pregunta, comentario };
  try {
    const res = await fetch(SCRIPT_URL, {
      method: "POST",
      mode: "no-cors",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify(data)
    });
    alert("âœ¨ ReflexiÃ³n guardada con Ã©xito.");
    document.getElementById("reflexion").value = "";
  } catch (e) {
    console.error(e);
    alert("OcurriÃ³ un error al guardar en Drive.");
  }
}
</script>

<!-- Manifest y Service Worker -->
<script>
  // Registro del service worker para instalaciÃ³n
  if ('serviceWorker' in navigator) {
    window.addEventListener('load', () => {
      navigator.serviceWorker.register('sw.js');
    });
  }
</script>
</body>
</html>
